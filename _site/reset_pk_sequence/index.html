<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Reset primary key sequence | Rails Examples</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Reset primary key sequence" />
<meta name="author" content="swapnil" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Resetting primary key sequence in Rails can be achieved by simply calling method reset_pk_sequence! on ActiveRecord with table_name." />
<meta property="og:description" content="Resetting primary key sequence in Rails can be achieved by simply calling method reset_pk_sequence! on ActiveRecord with table_name." />
<link rel="canonical" href="http://localhost:4000/reset_pk_sequence/" />
<meta property="og:url" content="http://localhost:4000/reset_pk_sequence/" />
<meta property="og:site_name" content="Rails Examples" />
<meta property="og:image" content="http://localhost:4000/assets/images/reset_pk.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-16T00:00:00+05:30" />
<script type="application/ld+json">
{"headline":"Reset primary key sequence","dateModified":"2020-04-16T00:00:00+05:30","datePublished":"2020-04-16T00:00:00+05:30","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"swapnil"},"@type":"BlogPosting","image":"http://localhost:4000/assets/images/reset_pk.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/reset_pk_sequence/"},"author":{"@type":"Person","name":"swapnil"},"description":"Resetting primary key sequence in Rails can be achieved by simply calling method reset_pk_sequence! on ActiveRecord with table_name.","url":"http://localhost:4000/reset_pk_sequence/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/ruby-on-rails.png">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!-- Google Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    <!-- This goes before </head> closing tag, Google Analytics can be placed here -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141780310-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141780310-2');
</script>


    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3769790781021403"
     crossorigin="anonymous"></script>
</head>

<body class="">

    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/index.html"><strong>Rails Examples</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02" style="">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
<a class="nav-link" href="/index.html">Home</a>
</li>

<li class="nav-item">
  <a class="nav-link" href="/leetcodes">Leetcodes</a>
</li>

<li class="nav-item">
<a class="nav-link" href="/author.html">About</a>
</li>
            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <script src="/assets/js/lunr.js"></script>

<script>
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 1000 );
        $( "body" ).removeClass( "modal-open" );
    });
});
    

var documents = [{
    "id": 0,
    "url": "http://localhost:4000/404/",
    "title": "",
    "body": " 404 Page not found :(  The requested page could not be found. "
    }, {
    "id": 1,
    "url": "http://localhost:4000/author.html",
    "title": "Author",
    "body": "{{page. title}}:     {% for author in site. authors %}                                         {{ author[1]. name }} :       (View Posts)      {{ author[1]. bio }}                          &nbsp;       &nbsp;       &nbsp;                                    {% endfor %}  "
    }, {
    "id": 2,
    "url": "http://localhost:4000/categories.html",
    "title": "Categories",
    "body": "          Categories          {% for category in site. categories %}     {{ category[0] }}:           {% assign pages_list = category[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 3,
    "url": "http://localhost:4000/contact.html",
    "title": "Contact",
    "body": "  Please send your message to {{site. name}}. We will reply as soon as possible!   "
    }, {
    "id": 4,
    "url": "http://localhost:4000/",
    "title": "RailsExamples - A place to learn rails",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 5,
    "url": "http://localhost:4000/leetcodes/",
    "title": "Leetcode",
    "body": "       {% assign sorted_posts = site. leetcodes | sort: 'date' | reverse %}  {% assign latest_post = sorted_posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = sorted_posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = sorted_posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = sorted_posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. leetcodes %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}                  All Stories:         {% for post in paginator. leetcodes %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 6,
    "url": "http://localhost:4000/privacy-policy.html",
    "title": "Privacy Policy",
    "body": "”{{site. name}}” takes your privacy seriously. To better protect your privacy we provide this privacy policy notice explaining the way your personal information is collected and used. Collection of Routine Information: This website track basic information about their visitors. This information includes, but is not limited to, IP addresses, browser details, timestamps and referring pages. None of this information can personally identify specific visitor to this website. The information is tracked for routine administration and maintenance purposes. Cookies: Where necessary, this website uses cookies to store information about a visitor’s preferences and history in order to better serve the visitor and/or present the visitor with customized content. Advertisement and Other Third Parties: Advertising partners and other third parties may use cookies, scripts and/or web beacons to track visitor activities on this website in order to display advertisements and other useful information. Such tracking is done directly by the third parties through their own servers and is subject to their own privacy policies. This website has no access or control over these cookies, scripts and/or web beacons that may be used by third parties. Learn how to opt out of Google’s cookie usage. Links to Third Party Websites: We have included links on this website for your use and reference. We are not responsible for the privacy policies on these websites. You should be aware that the privacy policies of these websites may differ from our own. Security: The security of your personal information is important to us, but remember that no method of transmission over the Internet, or method of electronic storage, is 100% secure. While we strive to use commercially acceptable means to protect your personal information, we cannot guarantee its absolute security. Changes To This Privacy Policy: This Privacy Policy is effective and will remain in effect except with respect to any changes in its provisions in the future, which will be in effect immediately after being posted on this page. We reserve the right to update or change our Privacy Policy at any time and you should check this Privacy Policy periodically. If we make any material changes to this Privacy Policy, we will notify you either through the email address you have provided us, or by placing a prominent notice on our website. Contact Information: For any questions or concerns regarding the privacy policy, please contact us here. "
    }, {
    "id": 7,
    "url": "http://localhost:4000/tags.html",
    "title": "Tags",
    "body": "          Tags          {% for tag in site. tags %}     {{ tag[0] }}:           {% assign pages_list = tag[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 8,
    "url": "http://localhost:4000/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ “sitemap. xml”   absolute_url }}   "
    }, {
    "id": 9,
    "url": "http://localhost:4000/page2/",
    "title": "RailsExamples - A place to learn rails",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 10,
    "url": "http://localhost:4000/page3/",
    "title": "RailsExamples - A place to learn rails",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 11,
    "url": "http://localhost:4000/self-keyword-in-ruby/",
    "title": "What is self in Ruby?",
    "body": "2023/09/08 - self is a keyword in ruby which means it is reserved by Ruby to serve a specific purpose and we cannot use it like regular variables (although you can override it, but you shouldn’t). What is self in Ruby?: Behaviour of self depends on what context it is defined. self can represent instance of class or the class itself. Let’s understand through examples. 1. within method: In this case, self represents the current instance of the class. It will be different for different instances of the class and will not intervene any proceedings between them. Example 1:class RailsExamples def method1  self. __id__ endendirb(main):1:0&gt; obj = RailsExamples. newirb(main):2:0&gt; obj. method1irb(main):3:0&gt; 460060irb(main):4:0&gt; irb(main):5:0&gt; obj. __id__irb(main):6:0&gt; 460060irb(main):7:0&gt; irb(main):8:0&gt; obj. method1 == RailsExamples. new. method1irb(main):9:0&gt; false 2. Within class: In this case self will represent the class itself. It will return the Class object under which it is defined. Let’s understand through example - Example 2:class RailsExamples def method1  self. __id__ end def self. method2  self. __id__ endendirb(main):1:0&gt; RailsExamples. method2=&gt; 992600irb(main):2:0&gt; RailsExamples. method2=&gt; 992600irb(main):3:0&gt; RailsExamples. __id__=&gt; 992600irb(main):4:0&gt; RailsExamples. new. method1. __id__=&gt; 2052721 3. Outside any context: When self is called outside any class or method, it refers the main object (the top-level context). irb(main):218:0&gt; p selfmain=&gt; mainHappy Coding!!! References -  keywords in Ruby"
    }, {
    "id": 12,
    "url": "http://localhost:4000/keywords-in-ruby/",
    "title": "Keywords in Ruby",
    "body": "2023/09/04 - Keywords are special words in Ruby which are reserved by the language and have predefined uses. Each keyword serves a different implementation than other. Let’s dive into these keywords and understand their definitions.  BEGIN -     Code inside BEGIN will run before any other code written in the current file.     END -     Code inside END will run after any other code written in the current file    alias -     alias helps to create an alias between two methods and	It has lower precedence than &amp;&amp; and is for short-circuit boolean    begin -     This Ruby keyword helps us to start an exception handling block    break -     It helps to leave a block early    case -     This Ruby keyword helps to start a case expression    class -     class helps user to create or opens a class in ruby    def -     def keyword in ruby helps us to define a function    defined? -     Defined? It describes its argument by returning a string     do -     This Ruby keyword helps to start a block of code    else -     Else is the unhandled condition in if and unless expression    elsif -     Elsif helps the user to give alternate conditions to if expression    end -     methods, modules, classes etc, use end. It indicates the end of a syntax blockfalse	False here means boolean false     ensure -     ensure is a block of code that will always run when an exception is raised    for -     To help us to create a loop for iteration    if -     Used as an expression for if or modifiers if    in -     It helps to separate iterable Objects and iterable variables in a for loop    module -     Helps us in creating or opening module    next -     Lets the user skips the rest of the code in the block    nil -     Nil represents false value indicating “no value” or “unknown. ”    not -     It inverts the boolean expression but has less precedence than “!”    or -     It represents boolean or with less precedence than “||”    redo -     Redo helps to restart execution in the present block    rescue -     It helps to start an exception section of code in a beginning block    retry -     It helps us to retries an exception block    return -     To exit from a method    self -     Helps in calling Object of current method attached to    super -     It helps in calling the current method in a superclass    then -     In control structure, It represents the end of the conditional block    true -     true here is just a simple boolean true expression    undef -     It helps in preventing module or class from responding to the method call    unless -     It helps in creating unless and modifiers unless expressions    until -     Help us to create an iterative loop until a condition is met    when -     it helps by representing a condition in a case expression    while -     Help us to create an iterative loop while a condition is true    yield -     yield Helps to start execution of block send to the current method    ENCODING -     It represents script encoding of the current file    LINE -     It represents the line number of keywords in the current file    FILE -     It represents the path to the current file.    Happy Coding!!! "
    }, {
    "id": 13,
    "url": "http://localhost:4000/what-is-libpq/",
    "title": "What is libpq?",
    "body": "2023/07/03 - You might have heard about libpq while installing/operating postgresql. But what is libpq? Let’s understand.  What is libpq?: libpq is a library that helps app to communicate with postgresql backend server. It is C application programmer’s interface. It helps in passing on queries and returning the result. Also: As per Postgresql docs - libpq is also the underlying engine for several other PostgreSQL application interfaces, including those written for C++, Perl, Python, Tcl and ECPG. So some aspects of libpq behavior will be important to you if you use one of those packages. In particular, Section 34. 15, Section 34. 16 and Section 34. 19 describe behavior that is visible to the user of any application that uses libpq. When it is used?: If you have Postgresql on your setup, then libpq will be needed and used as underlying interface to communicate with Postgresql backend server. How to install libpq?:  On Mac OS  brew install libpq    On Ubuntu  sudo apt-get install libpq-dev    Issues if not installed: -&gt; Installation of libpq should resolve this error. If you are still facing an issue, you might need to add libpq to path. Following is example for command terminal which uses zshrc. echo 'export PATH= /usr/local/opt/libpq/bin:$PATH ' &gt;&gt; ~/. zshrc Code Example to connect and print hello world: Code example - #include &lt;stdio. h&gt;#include &lt;stdlib. h&gt;#include &lt;libpq-fe. h&gt;static voidexit_nicely(PGconn *conn){  PQfinish(conn);  exit(1);}intmain(int argc, char **argv){  const char *conninfo;  PGconn   *conn;  PGresult  *res;  if (argc &gt; 1)    conninfo = argv[1];  else    conninfo =  dbname=postgres ;  /* Connect to the database */  conn = PQconnectdb(conninfo);  /* Verify success of database connection */  if (PQstatus(conn) != CONNECTION_OK)  {    fprintf(stderr,  Connection to database failed: %s ,        PQerrorMessage(conn));    exit_nicely(conn);  }  /* Execute a simple query and display the results */  res = PQexec(conn,  SELECT 'Hello World' );  printf( %s\n , PQgetvalue(res, 0, 0));  PQclear(res);  /* close the connection to the database and cleanup */  PQfinish(conn);  return 0;} References -  Postgresql libpq documentation Code reference"
    }, {
    "id": 14,
    "url": "http://localhost:4000/polymorphic-associations/",
    "title": "Polymorphic Associations in Rails",
    "body": "2023/06/19 - . What is the usecase?: Suppose two models can be associated to a third model with a common attribute. For example, Image can belong to User as well as Product, because user will have self image and product will have descriptive images of product. This can be achieved with Polymorphic associations - Two or more models can be associated to third model using single association. How to use it?: Let’s understand how to use it. There are two parts -  Migration defining two fields on the model which will have work as base model. It will have association_id -&gt; int and association_type -&gt; string.  Defining associations in models. And we are ready to use it. Lets understand through code example. Code Example: Suppose we have three models - Picture, User, Product. We need specify polymorphic association atpictures table creation 1. Migration: We will add two fields imageable_type and imageable_id. 2. Model associations changes: What if we do not use Polymorphic?: We will have to create two tables representing User-Image and Product-Image associations. That will bestoring same attributes in two tables except user_id and product_id. Benefits: The setup provides easy access to associated models.  From an instance of the User model, you can retrieve a collection of pictures: @user. pictures Similarly, you can retrieve @product. pictures If you have an instance of the Picture model, you can get to its parent via @picture. imageable Polymorphic association helps in making your code DRY(Do not Repeat Yourself)Can we test polymorphic associations?: Yes, of course. I am using rspec for unit testing instead of minitest. It can be installed from hereinstall rails rspec. If you had not installed rspec previously, run $ rails generate rspec:model user   create spec/models/user_spec. rb$ rails generate rspec:model product   create spec/models/product_spec. rb$ rails generate rspec:model picture   create spec/models/picture_spec. rbNow we have empty rspec files for models. Let’s add following code to picture model rspec file And when we run this spec file It will pass with flying colors! References -  Rails documentation rspec-rails. "
    }, {
    "id": 15,
    "url": "http://localhost:4000/ruby-modules-mixins-inheritance/",
    "title": "Multiple Inheritance in Ruby",
    "body": "2023/05/09 - In this post we will learn about multiple inheritance in ruby. What is Multiple Inheritance? It is property of code to inherit from multiple parent classes. Ruby supports inheriting only from one parent class.  So what is the way for inheriting from multiple classes? By the way are you aware of classic diamond problem inmulitple inheritance? If not, read more about it here. Here comes in play modules in Ruby. Modules are somewhat different than classes -  Modules can’t be instantiated, class can be instantiated Can’t create object of Modules, but can create object of class We can include multiple modules in a single class, but can’t include classesTo achieve multiple inheritance, we can include as many modules in a class. The same methods will be overriden by latest implementation. Let’s take a example - Here module A is included in class C and so when method name is called upon class C it results printing  A  Now let’s consider this example - Here we have two modules A and B. And when these two are included in class C, because both define same method name and module B is included after A - the program output is  B  And that’s how we can include multiple modules in same class. I hope this was useful! References -  The Diamond problem"
    }, {
    "id": 16,
    "url": "http://localhost:4000/remove-stale-pid/",
    "title": "Resolve early termination of worker in Rails",
    "body": "2022/12/12 - In this post we will resolve the error - Early termination of puma worker. Note - The reason described below is one of the cause, it is quite possible to reproduce this issue due to another reason. Let’s begin. Few days ago, like every normal day I started dev environment rails server and suddenly server log floodedwith error message - early-termination-of-worker. I did not understand at the time why it has happened as I did nothing different. Oh, but there was one thing to note - I had to abruptly shut down mac the day before. Was it even related? Yes, it was! While shutting down mac, postgres server was also abruptly closed - leading to stale postmaster. pid file in thesystem. And the other day when I was trying to start rails server, it was unable to connect to postgres server. The reason was postgres server was unable to start as system had stale postmaster. pid reference. If you are stuck at how I find out the reason, here it is - So after knowing the problem, answer was straight forward - Go and delete postmaster. pid file. How to do it? I use postgres desktop application, so these were steps for me -    Open terminal &amp; navigate to Postgres directory. You can find postgres directory by opening postgres app and clicking on server settings option. My path was - /Users/swapnil/Library/Application Support/Postgres/var-13   List all files in the directory and check if postmaster. pid file is present.   ls -a    Go ahead and remove postmaster. pid -  rm postmaster. pid   . That’s it. After this step your postgres server should be running &amp; so rails server will be able to connect to it. P. S. - If you installed postgres via different method then solution steps would be different for you. Thanks. Cheers! "
    }, {
    "id": 17,
    "url": "http://localhost:4000/allow-https-traffic/",
    "title": "Allow HTTPS traffic via AWS Load balancer and EC2",
    "body": "2021/04/07 - In this post we will achieve passing only https traffic to EC2 via application load balancer. Pre-requisites:  running EC2 instance SSL certificate added to AWS Certificate Manager- First we need to setup an AWS Load balancer. If you have load balancer created, then please skip to this stepAWS provides three types of LB - application, network and classic, while AWS itself promotes application LB for Modern web applications.     Create Application Load Balancer:      Open the Amazon EC2 console at https://console. aws. amazon. com/ec2/    On the navigation pane, open CREATE LOAD BALANCER.    Choose Create for Application Load Balancer.    -    Adding listener configuration:   We need to add where load balancer is listening. We also need to specify what action should be taken, but it is coveredlater in the post as it has a pre-requisite task. We will listen from both ports 80 and 443.          For port 443 (HTTPS) - On AWS console, for port choose HTTPS and for port choose 443.           For port 80 (HTTP) - On AWS console, for protocol choose HTTP and for port choose 80.       -    Configure Security Settings:   AWS Certificate Manager (ACM) is the preferred tool to provision and store server certificates. If you previously stored a server certificate using IAM, you can deploy it to your load balancer. From Certificate type dropdown choose Choose a certificate from ACM (recommended). Select Certificate from Certificate name dropdown.  -    Adding VPC and security groups:   Add appropriate VPC and security groups to your ALB  -    Adding target group:   Create new target group with protocol (HTTP) and port (80). For health check keep default settings or assign any otherroute your application has, it will be used for periodically checking health of target group. Use this target group toforward your traffic from listener port 443 (From the above steps).   -    Listeners &amp; targets settings:   Open listeners edit option and do changes for following      For port 80 (HTTP) - Open edit option. For Default action(s), choose Redirect to. Choose HTTPS &amp; 443 and Original host, path, query from dropdown. This will redirect all traffic on port 80 to port 443 (https) on same host.    For port 443 (HTTPS) - Open edit option. Select protocol HTTPS and port 443. For Default action(s), choose Forward to and then select your ALB target group from the drop-down menu. For Default SSL certificate, choose From ACM(recommended) and then choose the ACM certificate.    -    Already have Application Load Balancer up and running, then     In the navigation pane, choose Load Balancers and then choose your Application Load Balancer.    Choose Add listener.    For Protocol, choose HTTPS.    For port, choose 443.    For Default action(s), choose Forward to, and then select your ALB target group from the drop-down menu.    For Default SSL certificate, choose From ACM (recommended) and then choose the ACM certificate.    Choose Save.    If you are operating classic load balancer, then the process is slightly different. For classic LB, please refer to thisguide - https://aws. amazon. com/premiumsupport/knowledge-center/associate-acm-certificate-alb-nlb/ - Note: Make sure to apply proper security groups and subnet configuration to allow traffic only from expected load balancerotherwise EC2 instance would be still accessible via http to end user. References -    https://docs. aws. amazon. com/elasticloadbalancing/latest/application/application-load-balancer-getting-started. html     https://aws. amazon. com/premiumsupport/knowledge-center/associate-acm-certificate-alb-nlb/  "
    }, {
    "id": 18,
    "url": "http://localhost:4000/rails-add-default-to-enum/",
    "title": "Rails 6.1 - adds defaults value to enum",
    "body": "2020/07/04 - How do we define enums? Pretty much like class Book &lt; ActiveRecord::Base enum status: [:proposed, :written, :published]endHere what is the value of status for newly created object of class Book? It would be proposed, as is the first value from enums. What if we need a default enum value to be set to newly created objects? Well we can achieve it usingdatabase default value constraint, but it will not be assigned until object is saved to database i. e. Book. new. statuswill not reflect database default-value constraint as it is yet to be saved to database.  Rails 6. 1 added support to define default value for enum. Declaring likeclass Book &lt; ActiveRecord::Base enum status: [:proposed, :written, :published], _default: :publishedendSo now new object of class Book will show value for column status as published and not proposed. Book. new. status # =&gt;  published  More exampleclass Blog &lt; ActiveRecord::Base enum status: [:open, :inprogress, :complete], _default: :inprogressendBlog. new. status # =&gt;  inprogress  Thanks for reading.  References -  Rails master PR which adds _default enum by kamipo"
    }, {
    "id": 19,
    "url": "http://localhost:4000/rails-6-credentials/",
    "title": "Rails 6 - Managing API keys using 'credentials'",
    "body": "2020/07/04 - How do you manage application secret keys? We cannot commit them in Version Control System (like github), it is too dangerous. In the era of docker-kubernetes we make them available as environment variables using kubernetes secrets &amp; then applicationcode picks up from there. This way is okay but becomes lengthy when number of secrets keys goes up. Let’s talk about rails credentials now - the way for managing secret keys in the rails eco system itself. How differentthis approach is? Well, it stores secret keys in application code itself, but those are encrypted and needs a master key todecrypt. So, we can place just one secret key i. e. master key outside of VCS. Isn’t it good?  Create/edit credentialsEDITOR='VIM' rails credentials:editThis will create two files credentials. yml. enc &amp; master. key and open up decrypted credentials. yml. enc aws:  access_key_id: AWSACCESSKEYID  secret_access_key: AWSSECRETACCESSKEY# Used as the base secret for all MessageVerifiers in Rails, including the one protecting cookies. secret_key_base:This file will be encrypted again before saving. Note do not commit master. key file. The only key that would stored out of VCS is master key. There are multiple ways to achieve it.  Accessing these in rails environment as &gt; Rails. application. credentials. config =&gt; {:aws=&gt;{:access_key_id=&gt;AWSACCESSKEYID, :secret_access_key=&gt;AWSSECRETACCESSKEY}} Adding Environment wise Credentials: We can also keep dev, staging &amp; production env wise separate credential files. Let’s create it for development environment as - &gt; rails credentials:edit --environment developmentIt will open up in a default editor like aws:  access_key_id: 123  secret_access_key: 456Put in secrets in here &amp; then can be simply accessed in application as &gt; Rails. application. credentials. config =&gt; {:aws=&gt;{:access_key_id=&gt; DEVELOPMENT_KEY , :secret_access_key=&gt; DEVELOPMENT_ACCESS_KEY }}  The best thing I liked was this Even if you forget to remove secrets key file it will no be added to VCS as rails has moved it to gitignore. Thanks for reading. References -    Saeloun Blog on rails credentials     Medium Blog on environment wise credentials  "
    }, {
    "id": 20,
    "url": "http://localhost:4000/rails-grafana-dashboard/",
    "title": "Setting up Rails Performance dashboard with influxdb and grafana",
    "body": "2020/05/02 - When application gets stable at some point, we try to improve things we built for a while now. And improving performancetops the list for me. Application performance is a large concept which can be measured with different number of parameters. It also depends on underlying infrastructure. So here we will setup very simple and minimalistic performance dashboard for a Rails application which will help us monitor controller action runtime, database query runtime and view rendering runtime. Let’s start Pre-requisites  influxdb: install unless is_influxdb_installed? grafana: install unless is_grafana_installed? Rails app  Now add gem influxdb-rails gem to Rails application Gemfile and run bundle. To get things up run  bundle exec rails generate influxdb    This will create initialzer config/initializers/influxdb_rails. rb, which allows configuration of this gem.     We need one infuxdb database to store performance time series data, which eventually will be used by grafana dashboard. Open influxdb cosnole by running influx. If you face issue of connection refused, make sure influxd is running.  Once console is accessible create a database. I’m creating database named ‘rails-dev’ for now.   We need to tell our rails application what database it should look for to store data. If it is going to use database service from another instance, we must provide hostname. For all this, open influxdb initializer file. For database name - config. client. database =  rails-dev If you are going to use a hosted influxdb instance then provide its address here For hostname - config. client. hosts = [ host-name. com/8086 ]At this point we are set with storing performance metrics data into influxdb ‘rails-dev’.    Check if grafana installed is working. Open http://localhost:3005. Recheck if port number isappropriate. You can verify port number and other details of grafana from ‘grafana. ini’     Let’s import a simple dashboard in grafana. We will use already created dashboard for the rails app. Navigate to import screen &amp; paste this board id 10428. Grafana will updateconfiguration and import the board. That’s it. Import is pretty simple and straight forward.   Now we are all prepared to see live performance metrics of our application. After some requests grafana dashboard will look something like Thanks for reading. … References -  influxdb-rails gem influxdb installation grafana installation grafana import dashboard sample-dashboard"
    }, {
    "id": 21,
    "url": "http://localhost:4000/reset_pk_sequence/",
    "title": "Reset primary key sequence",
    "body": "2020/04/16 - Resetting primary key sequence in Rails can be achieved by simply calling method reset_pk_sequence! on ActiveRecord with table_name.  ActiveRecord::Base. connection. reset_pk_sequence!('table_name') What is Primary key sequence?It is a value maintained by database, which it refers to when adding new row. This is used to decide next value for primary key column. In most common scenario the column named id holds primary key for the table. When first row is being added, id is set to 1. At this time id_sequence would be 2. When second row is added, id_sequence would beset to 3 and likewise.  Why to reset this sequence?Sometimes due to imported records or other reason, id_sequence is not updated to hold the right value. Suppose we imported 10 records to the above schema with their ids from previous schema and those ids not conflicting with existing 2 records. And id_sequence is notupdated. Now the value of id_sequence is 3, at the same time record with id 3 is present(from imported records). In this case, database insert operation will fail with error duplicate primary key - validation failure.  How to reset?Open database console and run SELECT setval('your_table_id_seq', COALESCE((SELECT MAX(id)+1 FROM your_table), 1), false); How to reset from Rails console? ActiveRecord::Base. connection. reset_pk_sequence!('table_name') How to reset for all tables?ActiveRecord::Base. connection. tables. each do |t| ActiveRecord::Base. connection. reset_pk_sequence!(t)end…  References -StackOverflow - https://stackoverflow. com/a/244265 Rubyinrails - https://rubyinrails. com/2019/07/12/postgres-reset-sequence-to-max-id-in-rails/ "
    }, {
    "id": 22,
    "url": "http://localhost:4000/send-email-from-rails/",
    "title": "Sending Email from Rails",
    "body": "2020/03/06 - Sending email is integral part of every web application nowadays. In this post we will cover how to send emailsfrom a rails application. First you need an active smtp server to send an email, because only SMTP servers are capable of sending or receiving emails. There are many providers such as gmail, sendgrid and more. For this post, we will consider using gmail. Assuming you have a Rails application with User model.  We need to configure SMTP server. This can be set in config/environments/development. rb    config. action_mailer. delivery_method = :smtp  host = 'example. com' #replace with your own url  config. action_mailer. default_url_options = { host: host }    # SMTP settings for gmail  config. action_mailer. smtp_settings = {    :address       =&gt;  smtp. gmail. com ,    :port         =&gt; 587,    :user_name      =&gt; ENV['EMAIL'],    :password       =&gt; ENV['PASSWORD'],    :authentication    =&gt;  plain ,    :enable_starttls_auto =&gt; true  }      Lets write the code now. What will be sent in the email? Let’s say we want to send a welcome mail when user signs up. We will generate a mailer named - rails g mailer UserRegistration This will generate   Open app/mailers/user_registrations_mailer. rb and add method following method  def registration(user) @user = user mail(to: user. email, subject: 'Welcome to Rails learning')end    Open app/views/user_registrations_mailer &amp; add a new . erb file whose name resembles with method name in app/mailers/user_registrations_mailer. rb. In our case it is registration. html. erb, now put in whatever welcome message you want a user to see in email. I will simply add   Hello &lt;%= @user. first_name%&gt; &lt;%= @user. last_name %&gt;,   Welcome to Ruby on Rails learning.   Thanks for signing up.     We need to trigger the action of sending emails. There are multiple ways to achieve this. Can call this from controller action or a service call or activerecord callback. Will prefer last option hereIn User model register after_create callback   after_create :send_sign_up_email . . . private def user_registration_email  UserRegistrationsMailer. registration(self). deliver_now end   And now you are all set to send sign-up emails. "
    }, {
    "id": 23,
    "url": "http://localhost:4000/ruby-date-formatting/",
    "title": "Ruby date formatting",
    "body": "2020/01/01 - Ruby provides two classes to format date string strftime and strptime.  String to Date objectMethod parse of class Date converts string into date object with given directives. E. g. Date. parse('2020-01-01', '%Y-%m-%d')The provided directives can be changed according to given string format. Date. parse('01-01-2020', '%m-%d-%Y')=&gt; Wed, 01 Jan 2020Date. parse('31-01-2020', '%d-%m-%Y')=&gt; Fri, 31 Jan 2020Date. parse('01/01/2020', '%m/%d/%Y')  =&gt; Wed, 01 Jan 2020Some methods provided by Date class:  Find end of the month  Date. parse('2020-01-01', '%Y-%m-%d'). end_of_month=&gt; Fri, 31 Jan 2020    Find end of the year  Date. parse('2020-01-01', '%Y-%m-%d'). end_of_year=&gt; Thu, 31 Dec 2020    Find day of the calender week. Returns 1 to 7, Monday is 1  Date. parse('2020-01-01', '%Y-%m-%d'). cday=&gt; 1    Find day of the month.   Date. parse('2020-01-01', '%Y-%m-%d'). mday=&gt; 1    Find week of the year.   Date. parse('2020-12-31', '%Y-%m-%d'). cweek=&gt; 53    Find day of the year.   Date. parse('2020-12-31', '%Y-%m-%d'). yday=&gt; 366    Find lilian day number.   Date. parse('2020-12-31', '%Y-%m-%d'). ld=&gt; 160055    Find if given day is Sunday. Similar methods are available for all days of the week.   Date. new(2020, 12, 31). sunday?=&gt; false    Find date after x days from the date  Date. new(2020, 12, 31) + 8=&gt; Fri, 08 Jan 2021    Find date after x months from the date  Date. new(2020, 12, 31) &gt;&gt; 8=&gt; Tue, 31 Aug 2021   . Format directives :  %Y - Year with century (can be negative, 4 digits at least)     -0001, 0000, 1995, 2009, 14292, etc.  %C - year / 100 (round down.  20 in 2009) %y - year % 100 (00. . 99) %m - Month of the year, zero-padded (01. . 12)     %_m blank-padded ( 1. . 12)     %-m no-padded (1. . 12) %B - The full month name (``January'')     %^B uppercased (``JANUARY'') %b - The abbreviated month name (``Jan'')     %^b uppercased (``JAN'') %h - Equivalent to %b %d - Day of the month, zero-padded (01. . 31)     %-d no-padded (1. . 31) %e - Day of the month, blank-padded ( 1. . 31) %j - Day of the year (001. . 366)Time (Hour, Minute, Second, Subsecond): %H - Hour of the day, 24-hour clock, zero-padded (00. . 23) %k - Hour of the day, 24-hour clock, blank-padded ( 0. . 23) %I - Hour of the day, 12-hour clock, zero-padded (01. . 12) %l - Hour of the day, 12-hour clock, blank-padded ( 1. . 12) %P - Meridian indicator, lowercase (``am'' or ``pm'') %p - Meridian indicator, uppercase (``AM'' or ``PM'') %M - Minute of the hour (00. . 59) %S - Second of the minute (00. . 60) %L - Millisecond of the second (000. . 999) %N - Fractional seconds digits, default is 9 digits (nanosecond)     %3N millisecond (3 digits)  %15N femtosecond (15 digits)     %6N microsecond (6 digits)  %18N attosecond (18 digits)     %9N nanosecond (9 digits)  %21N zeptosecond (21 digits)     %12N picosecond (12 digits)  %24N yoctosecond (24 digits)Time zone: %z - Time zone as hour and minute offset from UTC (e. g. +0900)     %:z - hour and minute offset from UTC with a colon (e. g. +09:00)     %::z - hour, minute and second offset from UTC (e. g. +09:00:00)     %:::z - hour, minute and second offset from UTC                      (e. g. +09, +09:30, +09:30:30) %Z - Equivalent to %:z (e. g. +09:00)Weekday: %A - The full weekday name (``Sunday'')     %^A uppercased (``SUNDAY'') %a - The abbreviated name (``Sun'')     %^a uppercased (``SUN'') %u - Day of the week (Monday is 1, 1. . 7) %w - Day of the week (Sunday is 0, 0. . 6)Seconds since the Unix Epoch: %s - Number of seconds since 1970-01-01 00:00:00 UTC.  %Q - Number of milliseconds since 1970-01-01 00:00:00 UTC. Literal string: %n - Newline character (\n) %t - Tab character (\t) %% - Literal ``%'' characterCombination: %c - date and time (%a %b %e %T %Y) %D - Date (%m/%d/%y) %F - The ISO 8601 date format (%Y-%m-%d) %v - VMS date (%e-%b-%Y) %x - Same as %D %X - Same as %T %r - 12-hour time (%I:%M:%S %p) %R - 24-hour time (%H:%M) %T - 24-hour time (%H:%M:%S) %+ - date(1) (%a %b %e %H:%M:%S %Z %Y)…  ReferencesDate. parse - https://apidock. com/ruby/v2_5_5/Date/parse/class strptime - https://apidock. com/ruby/Date/strptime/class strftime - https://apidock. com/ruby/Time/strftime StackOverflow - https://stackoverflow. com/a/14619560/5235107 "
    }, {
    "id": 24,
    "url": "http://localhost:4000/postgresql-json/",
    "title": "json and jsonb - Postgresql",
    "body": "2019/12/10 - Postgresql provides a data-type jsonb to save data from JSON format. There are two ways for it - using jsonand jsonb. This article will clarify difference in short terms. json and jsonb are very similar to each other. The key difference is - jsonb is binary representation of json -as per postgresql documentation.  Pros - jsonb Improved efficiency Postgresql provides query interface for these types. So a direct query for any key in column can be made.  Simple database schema Cons - jsonb Slight overhead to convert into binary form.  Aggregate queries are slower (due to lack of statistics).  Due to large table footprints may take large disk space. … Querying json field:  Creating table  create table foo (id serial NOT NULL primary key, metadata json)  inserting test data  insert into foo(metadata) values ('{  property :  bar1  }'), ('{  property :  bar2  }')  fetching data from table foo  select * from foo     selecting json field  select id, metadata -&gt;'property' as property from foo    Cheers!!! References -    Official postgresql doc - link     postgresql tutorial blog - link  "
    }, {
    "id": 25,
    "url": "http://localhost:4000/sidekiq-by-example/",
    "title": "Sidekiq By Example : Ruby's background worker",
    "body": "2019/11/28 - What is the best way of handling background jobs in Rails, (maybe) using sidekiq. Let’s take step by step look into creating a Rails App and making a request for Background job using sidekiq System Pre-requisite  Ruby Rails Redis SidekiqNote: The repository of this project.  Create new Rails Project: We will create a new rails project named sidekiq-example Add sidekiq gem: In Gemfile add gem ‘sidekiq’ gem sidekiq Now run command bundle install. This will install gem sidekiq in our project. ➜ sidekiq-example: bundle install Generate Model: Let’s create a model named Team for reference with fields name, rating Also add this in seeds. rb Now Run ➜ sidekiq-example: rails db:create &amp;&amp; rails db:migrate &amp;&amp; rails db:seed It will create new database sidekiq_example_development for our application and create a table called teams in this database. Running seed data will insert sample 5 records in it.  Generate a controller: Create a controller for our actions under namespace api/v1/  Add routes: Let’s add routes for our actions. Add this in routes. rb.  Add Sidekiq worker: Now let’s work on Sidekiq part. To perform sidekiq jobs, add worker in app/workers. For our demo applicationit is BuyTimeWorker. And add method named perform in it. When a call to BuyTimeWorker made, it will be aasynchronous call to this method perform. The logic for background job will be in this method perform. To keep it simple for now, will just add sleep timer in it.  It simply sleeps for number of milliseconds passed to it. This job will run asynchronously when called. Let’s modify teams controller to make a call to this background job You can see action show is making call to BuyTimeWorker. What it means is when a url of kind '/api/v1/teams/:id'is hit, the controller action show will get called and background job BuyTimeWorker will be triggered. The action showwill not wait for job BuyTimeWorker to complete though it is called from within its definition. This job will be executed asynchronously with method show.  Run:  Start rails server Start Redis Start SidekiqIf you hit URL will found out something like this in sidekiq server log http://localhost:3001/api/v1/teams/2  ):Well this is very simple example of running background job in rails. You can write complex logic in Sidekiq workers. You can add multiple workers. Cheers! 🍻🍻 "
    }, {
    "id": 26,
    "url": "http://localhost:4000/run-migrations-on-first-docker-up/",
    "title": "Run seed data only on first Docker instance up",
    "body": "2019/11/22 - Q: Do we need to run rails db:seed, rails db:migrate every time the deployment happen? Ans - Absolutely no. rails db:seed should only run for the first time i. e. first deployment. But migrations shouldbe run on every deployments. So here is what we need - Run seed data only for first deployment. We will consider here containerised architecture. Here are steps - During deployment  Check if db exists If yes, then run rails db:migrate If no, then run rails db:create &amp;&amp; rails db:migrate &amp;&amp; rails db:seed How to determine if db exists during deployment? : Ans - After some googling, found out that a rake task can be written to determine if db exists   namespace :db do   desc  Checks to see if the database exists    task :exists do    begin     Rake::Task['environment']. invoke     ActiveRecord::Base. connection    rescue     exit 1    else     exit 0    end   end  end  This task tries to establish connection with the database, if exception occurs then return with exit 1. Exceptionoccurred, here, means the database does not exists. And no exception means connection established successfully andreturn with exit 0. To summarise,   if db does not exists then exit 1  if db exists then exit 0 Run seed data if db:exists, How? : Ans - In deployment script, the conditional bash logic can be executed like args: [  -c ,  env &amp;&amp; bundle exec rake db:exists; DB_EXISTS=$?; [[ $DB_EXISTS = 1 ]] &amp;&amp; (rails db:create db:migrate db:seed) || (rails db:migrate)  ]bundle exec rake db:exists; DB_EXISTS=$?; [[ $DB_EXISTS = 1 ]] &amp;&amp; (rails db:create db:migrate db:seed) || (rails db:migrate) This makes call to rake task above. Then collects its output into a variable DB_EXISTS. Then check if value of DB_EXISTS is equal to 1(which means db does notexists, according to our above assessment), IF YES THEN RUN rails db:create db:migrate db:seed, ELSE run rails db:migrate. Cheers! 🍻🍻 "
    }, {
    "id": 27,
    "url": "http://localhost:4000/http-request-part/",
    "title": "HTTP request response headers",
    "body": "2019/08/20 - At the end browser talks in the language of HTTP request. But we really know minimal about it. The request process flow is as simple as browser sends http request to the server and receives a response. Sometimes what we see is a combined result of responses from multiple requests. To summarize every image, text or anything seen on browser is a response received to an http request. Let’s see what a request and response headers of http request consists of. HTTP request headers can be broadly divided into 3 parts -  General Response Headers Request Headers General: Sample HTTP request format  GET /blog HTTP/1. 1  Let’s divide it into sections and see what each one means  MethodGET is a method used in http request which indicates type of work expected from request. There are methods like POST, DELETE, PUT, PATCH.  PathIt tells at what url should server look for. e. g. https://gryffindor. in/  VersionHTTP protocol version as 1. 1 or 2. 0  Status CodeIt is a 3 digit code that represents response from server. LikeStatus Code: 304 Response Headers: Sample HTTP request format  GET /blog HTTP/1. 1  Let’s divide it into sections and see what each one means  dateAll http requests use Greenwich Standard Time(GMT) or UTC. Here is common format - ‘Date: Fri, 23 Aug 2019 10:17:27 GMT’reference - RFC  statusIt is a 3 digit code that represents response from server. LikeStatus Code: 304  expiresTell the date when cookie will expire.  last-modifiedTells date and time when origin of content was last modified.  serverTells the web server used to process this http request.  cache-control Used to indicate various flags in cache control mechanism. Like     max-age - to indicate client accepts cached data whose age is not greater than value in seconds).    public - server can use any cache to store data   no-cache - cache must not use data for subsequent request without re-validation.    no-store - server can not use cache the request or response.    must-revalidate - revalidate stale data before using    Request Headers: Sample HTTP request format  GET /blog HTTP/1. 1  Let’s divide it into sections and see what each one means  AcceptTells about response formats that client can accept. e. g. text/html, application/json, application/xml, text/css, image/*, */*  RefererAllows client to specify from which URI this http request is generated/ requested. LikeReferer: https://buff. ly/It is of great help for analytics.  User agentIndicates which browser the request is sent from. likeuser-agent: Mozilla/5. 0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537. 36 (KHTML, like Gecko) Chrome/75. 0. 3770. 100 Safari/537. 36  Cache-control Used to indicate various flags in cache control mechanism. Like     max-age - to indicate client accepts cached data whose age is not greater than value in seconds).    public - server can use any cache to store data   no-cache - cache must not use data for subsequent request without re-validation.    no-store - server can not use cache the request or response.    must-revalidate - revalidate stale data before using    "
    }, {
    "id": 28,
    "url": "http://localhost:4000/ruby-range/",
    "title": "Ruby Ranges Overview",
    "body": "2019/08/15 - Range in ruby can be used in following situations  as SequenceRange can be used to generate a sequence as simple as (1. . 100) will generate a sequence from 1 to 100. array = (1. . 100). to_a will initialize an array of class Integer starting from 1 to 100. And it is easiest way to declare an array of sequencein ruby.  as Intervalsif ((1. . 10) === 5) puts  5 lies in (1. . 10)  end ===&gt; 5 lies in (1. . 10)    as condition   score = 70 result = case score  when 0. . 40 then  Fail   when 41. . 60 then  Pass   when 61. . 70 then  Pass with Merit   when 71. . 100 then  Pass with Distinction   else  Invalid Score end puts result   Cheers!!! "
    }, {
    "id": 29,
    "url": "http://localhost:4000/rails-command-line-tools/",
    "title": "Useful Rails commands",
    "body": "2019/08/05 -    rails dbconsole:  rails dbconsole figures out which database you’re using and drops you into whichever command line interface you would use with it (and figures out the command line parameters to give to it, too!). It supports MySQL (including MariaDB), PostgreSQL, and SQLite3. INFO: You can also use the alias “db” to invoke the dbconsole: rails db. $ rails dbconsole    rails runner:  runner runs Ruby code in the context of Rails non-interactively. For instance: $ rails runner  Model. long_running_method  INFO: You can also use the alias “r” to invoke the runner: rails r. You can specify the environment in which the runner command should operate using the -e switch. $ rails runner -e staging  Model. long_running_method  You can even execute ruby code written in a file with runner. $ rails runner lib/code_to_be_run. rb    rails notes:  rails notes searches through your code for comments beginning with a specific keyword. You can refer to rails notes --help for information about usage. By default, it will search in app, config, db, lib, and test directories for FIXME, OPTIMIZE, and TODO annotations in files with extension . builder, . rb, . rake, . yml, . yaml, . ruby, . css, . js, and . erb. $ rails notesapp/controllers/admin/users_controller. rb: * [ 20] [TODO] any other way to do this? * [132] [FIXME] high priority for next deploylib/school. rb: * [ 13] [OPTIMIZE] refactor this code to make it faster * [ 17] [FIXME]The app and helper objects: Inside the rails console you have access to the app and helper instances. With the app method you can access named route helpers, as well as do requests.  &gt;&gt; app. root_path =&gt;  /  &gt;&gt; app. get _ Started GET  /  for 127. 0. 0. 1 at 2014-06-19 10:41:57 -0300 . . . With the helper method it is possible to access Rails and your application’s helpers.  &gt;&gt; helper. time_ago_in_words 30. days. ago =&gt;  about 1 month  &gt;&gt; helper. my_custom_helper =&gt;  my custom helper Cheers!!! "
    }, {
    "id": 30,
    "url": "http://localhost:4000/previously_was/",
    "title": "Rails 6 adds *_previously_was attributes method",
    "body": "2019/08/02 - Rails had previous_changes method to track value of object before and after save.  person = Person. new(name:  Joe ) person. name =  Bill  person. previous_changes     # =&gt; { name  =&gt; [ Joe ,  Bill ]} person. name_previously_changed? # =&gt; true person. name_previous_change   # =&gt; [ Joe ,  Bill ] person. reload! person. previous_changes     # =&gt; {}Now *_previously_was is added to the list. It adds attribute methods for each attribute in the ActiveModel. In our case, Person has a attribute name. So it would be  person. name_previously_was   # =&gt;  Joe For a pirate class object it will look like  pirate. update(catchphrase:  Ahoy! ) #Before pirate. previous_changes[ catchphrase ] # =&gt; [ Thar She Blows! ,  Ahoy! ] #Now pirate. catchphrase_previously_was # =&gt;  Thar She Blows! SOURCE :commit Cheers! "
    }, {
    "id": 31,
    "url": "http://localhost:4000/scopes-in-rails/",
    "title": "Scopes in Rails",
    "body": "2019/07/11 - Recently I was calling create method on an active-record model object. But it failed in validation, because the provided foreign_key_id was not present in the associated table. My first guess was it might be a dangling reference. But I was wrong. There was a record with this foreign_key_id in its table. So what went wrong? It was a problem with default scope defined on an associated model. Let’s first understand how scopes work in Rails. When we define a scope on an ActiveRecord model  class Vehicle &lt; ActiveRecord::Base  scope :red, -&gt; { where(color: 'red') } enda class method is added to the Model. It is simply like this  class Vehicle &lt; ActiveRecord::Base  def self. red   where(color:'red')  end endThat means instead of querying Vehicle. where(color:'red'), we would be simply doing  Vehicle. redThe object returned by scope is always an ActiveRecord::Relation not Array. And this is the greatest benefit, because you can call allthe queries on this object just like any other Relation object.  Vehicle. red Vehicle. red. count Vehicle. red. where(type: 'Hatchback')You should always pass a callable object to the scopes defined with #scope. This ensures that the scope is re-evaluated eachtime it is called. . Default Scope: What if we need to query Vehicle model with some pre-fixed parameters. Suppose requirement is to show vehicles of drive type ‘Gear’ only. We must add the where(drive_type: 'Gear') clause to all the requests. Is there a better way with scopes? Yes!! Just by defining default scope we would be able to query the drive_type geared vehicles only. Just like  class Vehicle &lt; ActiveRecord::Base  default_scope {where(drive_type: 'gear')} endThis will add where(drive_type: 'gear') to all the request we make to Vehicle. This is just one way to use default scope. You can use default scopes n number of times in a Model. They all will beclub together in the resulting query.  class Vehicle &lt; ActiveRecord::Base  default_scope {where(drive_type: 'gear')}  default_scope {where(color: 'red')} endIn this way we are able to filter each request on Model with default scope. . . Unscoped: As much as we need default scope, we may also need to undo it at some places. It means calling a plain query on a Model without any pre-defined clause/s. It can be just like  Vehicle. unscoped. countIt will result Vehicle. count by removing default clause where(drive_type: 'gear') … How associations work with Scopes: Scopes have effect on associated classes. The default scopewill take effect when a parent class makes query to the associated class. Just like  class Klass &lt; ActiveRecord::Base  has_many :vehicles end class Vehicle &lt; ActiveRecord::Base  belongs_to :klass  default_scope {where(drive_type: 'gear')} endWhen a query is made from klass object to vehicles, the default scope  drive_type: 'gear' will be auto considered. …. Extended Scopes: Scopes can be extended to have methods defined within themselves. Suppose  class Vehicle &lt; ActiveRecord::Base  scope :geared, -&gt; {where(drive_type: 'gear')} do   def count    count   end      def pluck_ids    pluck(:id)   end endCalling Vehicle. geared. count would be equivalent to Vehicle. where(drive_type: 'gear'). count and likewise for pluck_ids. … Why not class methods?: From all the discussion about scopes, you might think why not use class methods instead? And yes it is absolutely fine to chooseclass methods over scopes. The only problem I see for now is the difference between how we handle the chain-ability of relations. For instance, consider  #Scopes class Vehicle &lt; ActiveRecord::Base  scope :color, -&gt; color { where(color: color) }  scope :gear, -&gt; { where(drive_type: 'gear') } end #Class method class Vehicle &lt; ActiveRecord::Base  def self. color(color)   where(color: color)  end    def self. gear   where(drive_type: 'gear')  end endWhen we call Vehicle. color('red'). gear, it would absolutely work. But for Vehicle. color(''). gear we won’t get any result,because the argument passed to color is blank. And it won’t be a desired output. If argument is nil or blank we would want to getall result instead. And will do this like  #Scopes class Vehicle &lt; ActiveRecord::Base  scope :color, -&gt; color { where(color: color) if color. present? } end #Class method class Vehicle &lt; ActiveRecord::Base  def self. color(color)   if color. present?    where(color: color)   else    all   end  end endIt is upto you what to choose. But I think we should consider what framework has to offer before re-inventing the wheel. … Edge case: Let’s assume data for more clear picture state_id is present in every cities record. And State model has a default scope on column_1 as where(column_1: 1).  class State &lt; ActiveRecord::Base  scope :one, -&gt; { where(column_1: 1) }  has_many :cities end class City &lt; ActiveRecord::Base  belongs_to :state endTo insert {name:'New York', state_id: 1} into cities, record with id 1 must exist in states table. But what if states id1 has column_1 set to 2 or any value other than 1. Will the default scope neglect them? Absolutely Yes!! The insertion query will fail with error message ActiveRecord::RecordInvalid: Validation failed: State must exist. Then, what is the solution?  class State &lt; ActiveRecord::Base  scope :one, -&gt; { where(column_1: 1) }  has_many :cities end class City &lt; ActiveRecord::Base  belongs_to :state, -&gt;{where(column_1: [1, 2, 3])} endDefining allowed column_1 values in the association itself will do the trick. Cheers!!! "
    }, {
    "id": 32,
    "url": "http://localhost:4000/string-comparison/",
    "title": "String Comparison: StringInquirer",
    "body": "2019/07/07 - Generally we use ==/===/eql?/equal? for string comparison in Rails. It does work in all scenarios we needed. But we often tend to look how same things can be done in more clean ways or how other developers in Railscommunity would have done that. str = 'x'str. eql?'X'str. equal?'X'str=='X'str==='X'The best place to look for such examples, in my opinion, is Rails repository on github itself. Let’s see how string comparison is done by Rails community inside Rails core code. There is a class in place called StringInquirer. Wrapping a string in this class gives you a prettier way to test for equality. The value returned by Rails. env is wrapped in a StringInquirer object, so instead of calling this: Rails. env == 'production'you can call this: Rails. env. production?Instantiating a new StringInquirer user = ActiveSupport::StringInquirer. new('admin')user. admin?  # =&gt; trueuser. admin? # =&gt; falseCheers! "
    }, {
    "id": 33,
    "url": "http://localhost:4000/squash-old-migrations/",
    "title": "Squasher: Replacing old migrations",
    "body": "2019/06/28 - Too many migrations in application makes it painful. Sometimes they are written a long time back, that now you do not even remember. At the point you might want to replace them with something simple and compact. Rails have a gem for this utility, called squasher. It eventually scans all the migrations in application and converts them into a single migration named InitSchema. Let's see by example.  Installation     Include gem squasher in Gemfile and run $ bundle install   To work effectively run $ bundle binstub squasher and you will have runner inside bin folder.    Now we are set to use squasher.  Usage     Let’s consider we need to squash all migrations before 2018. Simply run $ squasher 2018and squasher will create two migrations InitSchema and SquasherClean. InitSchema will be the new migration for all the migrations before 2018. Squasher afterward deletes all those now-redundent migrations.    Yes it is that simple! Let’s go down some depth:  Does Rails versioning affect our way?–&gt; Yes. By default squasher will not generate any rails versioning for newly generated migration. So there are high chances it may break during migrations. To counter it, squasher simply comes with option - -m, --migration=VERSION. It define the rails migration version(since Rails 5)  Can I squash migrations before a specific date?–&gt; Yes. Simply run squash command like$ squasher 2019/12/09It will squash migrations before 09 December, 2019. "
    }, {
    "id": 34,
    "url": "http://localhost:4000/modified-and-use-gem/",
    "title": "Modify a gem and use it in Rails",
    "body": "2019/06/28 - Sometimes a situation arises where we need to modify a gem according to our requirement and then successfully integrate into our project. Let’s find out! 1. Download the repository of required gem from github. 2. Open codebase in any of the editor. Play with it(Rather make meaningful changes!). 3. Build gem locally. This is the most important STEP!!!Run `gem build foo. gemspec`This will create foo. gem file in the same directory. Remember the path of this directory. 4. In Gemfile put it down likegem 'foo', path: 'path/to/above/directory' 5. Run `bundle install` And amigo you will be using the modified gem version.  Note: This setup will be helpful, mostly for try and test approach. For a slightly better approach you can use github. To use github, remember, the git source of gem must be specified. 3. In Gemfile put it down likegem 'foo', github: 'path/to/repository/relative/to/github', branch: 'your_branch' 4. Run `bundle install` And you are off to the mark. "
    }, {
    "id": 35,
    "url": "http://localhost:4000/rails-request-lifecycle/",
    "title": "Rails Request Lifecycle...",
    "body": "2019/06/12 - Have you ever wondered how a request is processed in its lifecycle? What happens with request at each stage? Who handles request at what level? Let’s dig it out! Breakdown of request flow -  Browser generates HTTP/HTTPS request after a click or a event Web server receives request, analyses it and passes to application server Application server calls up proper controller-action after talking with router The resulted output is sent back to browser and displayed on screen.  Web Browser : Browser should direct request to a specific destination. For users it is a URL seen on web page, but computers need IP addresses, they do not understand these URLs. For this purpose, there is a system in place called Domain Name System(DNS) which maps URLs to computer understandable IP addresses. It is browser who starts finding out IP address. Search begins from local cache, of both browser and computer. If local cache does not have IP address of requested site, browser generally asks Internet Service Providers(ISP). If not found then it goes up the hierarchy LIKE Root DNS –&gt; Extension wise Name Servers(like . com, . net, . org) –&gt; And then to Authoritative DNS Server. The chase ends here. Yay! We get the required ip address. Authoritative DNS Server must have IP address for requested site, if not there are high chances that your domain name provider has not set up your domain information properly. It is actually interesting to try on terminal with dig, . .  Web Server : By now browser is successfully connected to server. The server here is web server. Some examples are Apache,Nginx, Passenger, Puma, Unicorn, Webrick. These servers are meant to talk only in http. Their job is to understand the request and make decision on how to sevice that request. For simpler request, we can configure web server easily. Suppose we need to tell web server that if browser asks for any assets then serve it from ‘/public/assets’ folder. There are a list of different web servers you can use for this purpose. With nginx it is like Okay then. We are set to serve requests for assets. If browser asks for assets it will receive an expected response in output,for anything else than assets, it will get 404 not found response. But what if browser asks for latest 10 blog posts from xyz author with some amazing styling and javascript?? Our current configuration does not support this kind of request. Even if we decide to handle it at this level, it will be complex to put it in web server configuration file. So what next? There comes Rails! Web server passes request to Rails application. But there can be many ways for web server to do it. Just to understand, it can call a method with argument or declare variables or use global variables. Even if we managed this, another question arises, in what format should Rails sends data back to web server? To reduce this confusion, there is a system in place called RACK . . . RACK App: Rack is a simple Ruby protocol/convention that does a few things. The web server needs to tell the web framework, “Hey, here a request for you to handle. By the way, here are the deets for the request: paths, http verb, headers, etc. ” On the other hand, the framework needs to tell the server, “Hey, that’s cool, I’ve handled it. Here is the result… the status code, headers, and body. ” In order to remain lightweight and framework agnostic, Rack picked the simplest possible way to do this in Ruby. It notifies the web framework using a method call, communicates the details as method arguments, and the web framework communicates back by return values from the method call. In code it just looks like Web server creates env hash to pass it to Rack’s call method. This env hash has information like http_verb, http_method, parameters, rack_app_version, etc. And the call method responds in three variables - status, header and body. Status is http status, to tell about request completedsuccessfully or whatever happened with it. Headers is a hash of http headers, and Body is an array of response. Coming to rails, the config. ru file will look something like It is supposed to pass Rack application to run keyword, this means Rails. application is a Rack app and must respond to call method. . . . . Our app: Finally request reaches our app. It is evaluated by again a Rack app generated by Rails using routes. rb!!! Yes that’s too muck Rack apps around. But Rails is always been that. config/routes. rb - This will ultimately generate these seven routes From here, most of us know how it works. If request is for '/books' and is of kind GET, it will go to BooksController#index action. Request GET for '/books/:id' will go to BooksController#show and likewise! That’s it from the Rails Request Lifecycle.  Cheers!!!   Please enable JavaScript to view the comments powered by Disqus.  "
    }, {
    "id": 36,
    "url": "http://localhost:4000/how-index-works-on-database/",
    "title": "How Indexes on database works!",
    "body": "2018/06/08 - When it comes to performance of an application, databases are highly important and effective. And one of the key factor in database optimisation is index. It helps in getting results faster for select and where queries.  What is Index ?: Index is simply a data-structure that holds pointer to rows that has value for a column. It narrows down the number of rows to look out for. Indexes can be created using one of the B-tree, Hash, GiST, GIN.  Comparison of B-tree/Hash/Gist (Generalised Search Tree) /GIN (Generalised Inverted Index)Skip this if you know B-tree and Hash comparison. Most commonly index are created using B-tree, because they are very efficient in time complexity. As well B-tree can handle equality and range queries i. e. &lt;, ≤, &gt;, ≥ operations. B-tree can also sort data in it. Hash indexes can only handle equality(=) operations. Use of Hash index is discouraged by postgresql due to some issues. Hash index operations are not presently WAL-logged, so hash indexes might need to be rebuilt with REINDEX after a database crash if there were unwritten changes. Also, changes to hash indexes are not replicated over streaming or file-based replication after the initial base backup, so they give wrong answers to queries that subsequently use them. For these reasons, hash index use is presently discouraged.    Syntax for Creating index     CREATE INDEX index_name ON table_name (column1, column2, . . );   How Index works ?: Suppose we have a users table(id, name) indexed on name. When a record is inserted in users table, respective entry in B-tree would be made. At the moment users table have entries (1, ‘Deepak’), (2, ‘Rohit’), (3, ‘MSD’), (4, ‘Aaradhya’). The indexed B-tree would look like [Aaradhya, Deepak, MSD, Rohit].  For instance, I insert a record (5, ‘Swapnil’), B-tree would be updated to [Aaradhya, Deepak, MSD, Rohit] and node Rohit will point to [Rohit, Swapnil]. The searching operation are made easy because the data is sorted. If you are interested in postgresql code, take a look here on how postgresql works. When search query for name Swapnil is fired, unlike sequentially traversing users table as in without indexing, B-tree will efficiently find it is in node Rohit. Note that after locating node, it switches to binary search to reach Swapnil. Here is the source code to search value in single B-tree in postgresql.  A take on insert/update with index: Insert is the only operation which do not directly benefits from index, as it do not include where clause. Additionally it increases time for inserting. Let’s take a look. When not using index, a database insert operation would only add a row to table. But while using index, it additionally needs to add index-entry in B-tree. And it takes time, first to lookup appropriate node, assign value to node then to maintain B-tree split the node, if needed. In update query, when record is updated in database, the index for the same also gets updated. Building indexes concurrently: Most database systems allow to perform reads while creating index in a single scan, but lock parallel write operations. Transactions involving insert, update, delete will be blocked until index build is finished. And this could have sever impact if system is a live production database. Postgresql supports building indexes without locking with CONCURRENTLY option of CREATE INDEX. It performs two scans of table. First index is entered in system catalog in one transaction. Then two transactions perform two scans. Before each table scan, the index build must wait for existing transactions that have modified the table to terminate. After the second scan, the index build must wait for any transactions that have a snapshot predating the second scan to terminate. When these write operations are done, both scans complete and assures updated data. The reads were never a problem. Read more CREATE INDEX CONCURRENTLY index_name ON table_name (column1, column2, . . ); Last Stop:  Indexes does not store values of columns other than indexed ones.  Indexes should be created on columns which are queried frequently.  To optimise insert performance, it is very important to keep the number of indexes small. Have a great day! Cheers!!! "
    }, {
    "id": 37,
    "url": "http://localhost:4000/api-in-rails-5/",
    "title": "APIs in Rails 5.0 - overview",
    "body": "2018/03/23 - Have you ever wonder how APIs work in the world of convention over configuration, specifically in Rails 5. 0? Rails keeps continuing its legacy of convention over configuration in APIs also. Before Rails 5, we used to use rails-api to implement APIs. But now rails-api is merged to core Rails. So Rails 5 has in-built support for APIs. That’s great!!! Web app or API appIn normal rails web app, there are two parts. One part retrieves data to be served, and other part renders that data into HTML, CSS to see a beautiful webpage. And to note, both the parts are done by Rails itself. But in case of APIs, rails will only be responsible for retrieving data ( it will return data in JSON, XML, etc formats as output ) and the rendering will be performed by other framework like AngularJs, etc or it is just out of scope of rails. What is different in API mode?The major difference in API mode would be, to cut down the needed setup to a very minimal. It would not generate views, helpers and assets. Basically, API mode removes functionality that you do not need. If you start building API server first Rails app, this will do three main things for you -    Configure your application to start with a more limited set of middleware than normal. Specifically, it will not include any middleware primarily useful for browser applications (like cookies support) by default.     Make ApplicationController inherit from ActionController::API instead of ActionController::Base. As with middleware, this will leave out any Action Controller modules that provide functionalities primarily used by browser applications.     Configure the generators to skip generating views, helpers and assets when you generate a new resource.  That’s it! A short introduction on Rails APIs. Stay tuned for How to build an Rails API app. Medium Blog "
    }, {
    "id": 38,
    "url": "http://localhost:4000/rails-includes-vs-joins/",
    "title": "Rails Includes vs Joins",
    "body": "2018/03/08 - When I started learning Rails, I was always in a state of confusion about using includes or joins,because both are used in almost same scenario. Includes uses eager loading whereas joins uses lazy loading. Both are used when certain operations are meant to be performed on associated tables. And here comes the difference. What is the problem with Joins?: Here, we retrieved users in the first line and data is formatted in the each do loop. Here is interesting thing, to retrieve user. company. name, each time a call to database is made. It means, if there are 10k users then 10k separate queries would be fired up. And this will overkill system when scaled up. Isn’t there is efficient way? Yes, it is Includes. And this will overkill system when scaled up. Isn’t there a more efficient way? Yes, it is Includes. INCLUDES: If we go through Rails documenting, it clearly says - ’With includes, Active Record ensures that all of thespecified associations are loaded using the minimum possible number of queries’. When we need data to be usedfrom associated tables, includes must be used. Here is an example, Here, the data from table companies is brought right in the first line, since it says includes companies. No additional query is fired from the do loop for ‘user. company. name’. Size of users table does not matter now. It is scalable to any size. Isn’t it fantastic? Yes, it is. It saves hell lot of time. And it proves to be very efficient, when applicationcontains huge data.  So, does includes always preferred over joins?Hopefully not, there are some cases when includes does not exceed joins in terms of efficiency. Here, we used tables users and companies, but companies is only for some sort of filter. We did not actually used data from companies later in the code. So no need to bring data from companies along with users. This is why join is efficient in this case. … Eager Loading: It joins everything in a single query. Sometimes the query may result in a huge sql call with too many joins left joins. User. eager_load(:posts) … Pre Loading: Preload works in same way as Includes. It brings up the data normally in two queries. User. pre_load(:posts)–&gt; SELECT  users . * FROM  users  SELECT  posts . * FROM  posts  WHERE  posts .  user_id  IN (1) Cheers!!! "
    }, {
    "id": 39,
    "url": "http://localhost:4000/why-rails-why-ruby/",
    "title": "Why Rails? Why Ruby?",
    "body": "2018/02/28 - Ruby on Rails has been a prominent framework for web applications for last couple of years. But what has made it so worthy? Here are some findings,  Why Ruby?Ruby provides large, rich set of features, is less syntactic than Java. It is created with developers in mind, to make developers happy.  Convention over configurationRails prefers convention over configuration. You will build application in very less time, if continued with the standard rails follows. e. g. For User model, a table users will be created in database, unless you wish to change it some other name.  Easy to LearnIf you know any programming language (like C, C++, Java, C#, Python), then you will find ruby very easy to understand.  Great CommunityRails has large number of committers who make sure it is in top condition. Many projects goes down with age, but rails has grown vast due to great community support.  Compatibility with latest technologiesRails now can be used with any JS library, such as react. It also works with Angular JS. Rails community has maintained its compatibility with latest tech changes. …  NotesTo build a good product, one should choose a proven, reliable and community supported framework. And Rails offers all of it. Rails is used by thousands of websites and some major tech companies such as GitHub, Airbnb, Netflix, Twitter. "
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});


    
function lunr_search(term) {
    $('#lunrsearchresults').show( 1000 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow-lg" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><small><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
</script>
<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>




<form class="bd-search hidden-sm-down" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
<input type="text" class="form-control text-small"  id="lunrsearch" name="q" value="" placeholder="Type keyword and enter..."> 
</form>
            </ul>
        </div>
    </div>
    </nav>

    <!-- Search Results -->
    <div id="lunrsearchresults">
        <ul class="mb-0"></ul>
    </div>

    <!-- Content -->
    <main role="main" class="site-content">
        
<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
                        <span class="catlist">
						
                          <a class="sscroll text-danger" href="/categories.html#rails">rails</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/categories.html#postgres">postgres</a><span class="sep">, </span>
                        
                          <a class="sscroll text-danger" href="/categories.html#database">database</a><span class="sep">, </span>
                        
                        </span>
					</p>
					<div class="d-flex align-items-center">
                        
                        <img class="rounded-circle" src="/assets/images/swapnil.jpg" alt="Swapnil Gourshete" width="70"/>
                        
						<small class="ml-3"> Swapnil Gourshete <span><a target="_blank" href="https://twitter.com/gourshete" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Apr 16, 2020 · <span class="reading-time">
  
  
    1 mins read
  
</span>
    </span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/assets/images/reset_pk.jpg" alt="Reset primary key sequence">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">
        
        
        <!-- Share -->
		<div class="col-lg-2 pr-4 mb-4 col-md-12">
			<div class="sticky-top sticky-top-offset text-center">
				<div class="text-muted">
					Share this
				</div>
				<div class="share d-inline-block">
					<!-- AddToAny BEGIN -->
					<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
						<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
						<a class="a2a_button_facebook"></a>
						<a class="a2a_button_twitter"></a>
						<a class="a2a_button_email"></a>
						<a class="a2a_button_linkedin"></a>
					</div>
					<script async src="https://static.addtoany.com/menu/page.js"></script>
					<!-- AddToAny END -->
				</div>
			</div>
		</div>
        
        
		<div class="col-md-12 col-lg-8">
            
            <!-- Article -->
			<article class="article-post">                
			<p>Resetting primary key sequence in Rails can be achieved by simply calling method <code class="highlighter-rouge">reset_pk_sequence!</code> on ActiveRecord with 
<code class="highlighter-rouge">table_name</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">reset_pk_sequence!</span><span class="p">(</span><span class="s1">'table_name'</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>What is Primary key sequence?</li>
</ul>

<p>It is a value maintained by database, which it refers to when adding new row. This is used to decide next value for primary key column. In 
most common scenario the column named <code class="highlighter-rouge">id</code> holds primary key for the table.</p>

<p>When first row is being added, <code class="highlighter-rouge">id</code> is set to <strong>1</strong>. At this time id_sequence would be <code class="highlighter-rouge">2</code>. When second row is added, id_sequence would be
set to <code class="highlighter-rouge">3</code> and likewise.</p>

<ul>
  <li>Why to reset this sequence?</li>
</ul>

<p>Sometimes due to imported records or other reason, id_sequence is not updated to hold the right value. Suppose we imported 10 records 
to the above schema with their ids from previous schema and those ids not conflicting with existing 2 records. And id_sequence is not
updated.</p>

<p>Now the value of id_sequence is <code class="highlighter-rouge">3</code>, at the same time record with id <strong>3</strong> is present(from imported records). In this case, 
database insert operation will fail with error <code class="highlighter-rouge">duplicate primary key - validation failure</code>.</p>

<ul>
  <li>How to reset?</li>
</ul>

<p>Open database console and run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT setval<span class="o">(</span><span class="s1">'your_table_id_seq'</span>, COALESCE<span class="o">((</span>SELECT MAX<span class="o">(</span><span class="nb">id</span><span class="o">)</span>+1 FROM your_table<span class="o">)</span>, 1<span class="o">)</span>, <span class="nb">false</span><span class="o">)</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>How to reset from Rails console?</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">reset_pk_sequence!</span><span class="p">(</span><span class="s1">'table_name'</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>How to reset for all tables?</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">tables</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">reset_pk_sequence!</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>…</p>

<ul>
  <li>References -</li>
</ul>

<p><a href="https://stackoverflow.com/a/244265">StackOverflow</a> - <a href="https://stackoverflow.com/a/244265">https://stackoverflow.com/a/244265</a></p>

<p><a href="https://rubyinrails.com/2019/07/12/postgres-reset-sequence-to-max-id-in-rails/">Rubyinrails</a> - <a href="https://rubyinrails.com/2019/07/12/postgres-reset-sequence-to-max-id-in-rails/">https://rubyinrails.com/2019/07/12/postgres-reset-sequence-to-max-id-in-rails/</a></p>
                
			</article>
			<div>
				<br>
			</div>
			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				</span>
			</div>
            
             <!-- Author Box -->
                				
				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                         
                        <img class="rounded-circle" src="/assets/images/swapnil.jpg" alt="Swapnil Gourshete" width="90"/>
                         
					</div>
					<div class="col-md-10">		
                        <h5 class="font-weight-bold">Written by Swapnil Gourshete <span><a target="_blank" href="https://twitter.com/gourshete" class="btn btn-outline-success btn-sm btn-round ml-2">Follow</a></span></h5>
						Hi I am Swapnil, a Software Engineer and computer science enthusiastic					
					</div>
				</div>				
                
            
            <!-- Comments -->
            
                <!--  Don't edit anything here. Set your disqus id in _config.yml -->

<div id="comments" class="utterances">
    <div id="comments_thread">
    </div>
    <script src="https://utteranc.es/client.js"
        repo="gourshete/blog-comments"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
</div>
            
            
		</div>
        
        
	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/send-email-from-rails/"> <img height="30px" class="mr-1" src="/assets/images/send-email-1.jpg">  Sending Email from Rails</a>
            </div>
          
          
            <div class="col-md-6 text-right pr-0">
                <a class="text-dark" href="/rails-grafana-dashboard/"> Setting up Rails Performance dashboard with influxdb and grafana  <img height="30px" class="ml-1" src="/assets/images/grafana-dashboard.png"> </a>
            </div>
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <span class="navbar-brand mr-2 mb-0"><strong>RailsExamples</strong></span>
                <span>Copyright © <script>document.write(new Date().getFullYear())</script>.</span>
            </div>
            <div>
                Maintained with <i class="fa fa-heart"></i> by Swapnil
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before </body> closing tag --> 


</body>

</html>
